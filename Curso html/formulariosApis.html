<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>apis</title>
	</head>
	<style>
		table{
			text-align: center;
			background-color: #F96;
			width: 25%;
			margin: auto;
			border: 2px brown dashed;
		}
		td{
			padding: 15px;
		}
	</style>
	<script>
		var edad;
		function comenzar() {
			edad= document.getElementById("miedad");
			edad.addEventListener("change", cambiarRango, false);
			document.datos_usuario.addEventListener("invalid", validar, true);

			document.getElementById("Enviar").addEventListener("click", enviar, false);

			document.datos_usuario.addEventListener("input", validarTiempoReal, false);
			
		}

		function cambiarRango(argument) {
			var salida=document.getElementById("rango");

			var calculo=edad.value-30;
			if (calculo<30) {
				calculo=0;

				edad.value=30;
			}
			salida.innerHTML=calculo+"a " +edad.value;

		}

		function validar(e) {//e es un objeto del evento invalid
			var elemento=e.target;//con target nos devuelve el elemento que no es valido
			elemento.style.background="red";
		}

		function enviar(argument) {
			var cuadroUsuario= document.getElementById("usuario");
			var correcto= document.datos_usuario.checkValidity();//el metodo chekvalidity nos devuelve true o false si la validacion tuvo exito o no

			if (correcto==true) {
				document.datos_usuario.submit();//con esto se envia el formulario

			}
			else if (cuadroUsuario.validity.valueMissing==true || cuadroUsuario.validity.patternMismatch==true) {
				alert("El usuario no puede estar vacío y recuerda tiene que tener maximo 3 letras");
			}
		}

		function validarTiempoReal(e) {
			var elemento=e.target;
			if (elemento.validity.valid==true) {
				elemento.style.background="white";
			}
			else{
				elemento.style.background="red";
			}

		}
		
	

		window.addEventListener("load",comenzar,false);
			
	</script>

<body>
	<section>
		<!-- <form name="registro" method="get">
					<datalist id="informacion">
				<option value="8232323" label="telefono 1">
				<option value="5234323" label="telefono 2">
				<option value="6564323" label="telefono 3">
				
			</datalist>
			Teléfono: &nbsp;<input type="tel" name="telefono" id="telefono" list="informacion"> 
		</form>-->

<form name="datos_usuario" method="get">
	<table>
		<tr>
			<th colspan="2">
				formulario
			</th>
		</tr>
		<tr>
				<td>
					Usuario:
				</td>
				<td>
					<input pattern="[A-Za-z]{3}" name="usuario" id="usuario" maxlength="10" required>
				</td>
		</tr>
		<tr>
				<td>
						Email
				</td>
				<td>
						<input type="email" name="miemail" id="miemail" required>
				</td>
		</tr>
		<tr>
				<td>
					edad:
				</td>
				<td>
					<input type="range" name="miedad" id="miedad" min="0" max="120"value="30" step="30">
				</td>
		</tr>
		<tr>
			<td>
				<output id="rango">0 a 30</output>
			</td>
		</tr>
		<tr>
				<td>
					<input type="submit" id="Enviar" value="Registrar">
				</td>
		</tr>
	</table>
</form>
</section>
</body>
</html>